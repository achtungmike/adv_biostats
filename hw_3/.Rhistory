install.packages("multcomp")
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_2")
library(multicomp)
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_2")
library(multcomp)
dat <- litter
dim(dat)
View(dat)
?litter
version
summary(dat)
class(dat)
sapply(dat, class)
head(dat)
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(multcomp)
dat <- litter
summary(dat)
dim(dat)
# The data has 74 rows/observations and 4 columns/variables.
sapply(dat,class)
levels(dat$dose)
summary(dat)
means <- aggregate(weight ~ dose, dat, mean)
means$weight <- round(means$weight, 3)
means
mod <- lm(weight ~ dose, dat)
summary(mod)
var_mod <- aov(weight ~ dose, dat)
shap_test <- shapiro.test(mod$residuals)
shap_test
# We can see with a p-value of 0.434 which is greater than 0.05 that according
# to the Shapiro-Wilk test our data is both normal and homoscedastic.
tukey <- TukeyHSD(var_mod)
tukey
par(las=2)
par(mar = c(5,8,4,2))
plot(tukey)
par(mar = c(5,4,8,2))
lin_hyp <- glht(var_mod, linfct = mcp(dose = "Tukey"))
plot(cld(lin_hyp, level = 0.05), col = "coral1")
dbl_mod <- lm(weight ~ dose + gesttime, dat)
summary(dbl_mod)
dbl_tuk <- glht(dbl_mod, linfct = mcp(dose = "Tukey"))
summary(dbl_tuk)
summary(var_mod)
install.packages("CARS")
dat <- Highway1
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(CARS)
dat <- Highway1
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(car)
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(car)
dat <- Highway1
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(car)
dat <- Highway1
dim(dat)
dim(dat)
# The Highway1 dataset has 39 rows/observations and 12 columns/variables
# Top 10 rows of Highway1:
head(dat, 10)
# Summary statistics of Highway1:
summary(dat)
?Highway1
#   adt:    average daily traffic count in thousands
#   trks:   truck volume as percent of total volume
#   sigs1:  number of signals per mile of roadway
#   slim:   speed limit of stretch of road in 1973
#   shld:   width of outer shoulder on road [feet]
#   lane:   total number of traffic lanes
#   acpt:   nummber of access points per mile
#   itg:    number of freeway-type interchanges per mile
#   lwid:   lane width [feet]
#   htype:  Type of roadway or source of funding for road
sapply(dat, class)
dat[1,1]
levels(dat$htype)
dat$l_rate  <- log(dat$rate)
dat$l_len   <- log(dat$len)
dat$l_adt   <- log(dat$adt)
dat$l_trks  <- log(dat$trks)
dat$l_sigs1 <- log(dat$sigs1)
l_dat <-  dat[,6:12]
View(l_dat)
# Transforming variables as needed
l_dat$l_rate  <- log(dat$rate)
l_dat$l_len   <- log(dat$len)
l_dat$l_adt   <- log(dat$adt)
l_dat$l_trks  <- log(dat$trks)
View(dat)
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(car)
dat <- Highway1
dim(dat)
# The Highway1 dataset has 39 rows/observations and 12 columns/variables
# Top 10 rows of Highway1:
head(dat, 10)
# Summary statistics of Highway1:
summary(dat)
# This dataset has auto accident rates per million vehicle miles for 39 stetches of road
# in Minnesota in the year 1973, as well as other variables to describe that stretch of
# road.  It was put together by Carl Hoffstedt.
# Variables:
#   rate:   auto accident rate in 1973 [accidents/million vehicle miles]
#   len:    length of a highway segment [miles]
#   adt:    average daily traffic count in thousands
#   trks:   truck volume as percent of total volume
#   sigs1:  number of signals per mile of roadway
#   slim:   speed limit of stretch of road in 1973
#   shld:   width of outer shoulder on road [feet]
#   lane:   total number of traffic lanes
#   acpt:   nummber of access points per mile
#   itg:    number of freeway-type interchanges per mile
#   lwid:   lane width [feet]
#   htype:  Type of roadway or source of funding for road
sapply(dat, class)
levels(dat$htype)
# All variabes are either numeric or integers (no decimals) except for htype
# which is a factor/categorical with 4 levels, "FAI", "MA", "MC", "PA".
l_dat <-  dat[,6:12]
# Transforming variables as needed
l_dat$l_rate  <- log(dat$rate)
l_dat$l_len   <- log(dat$len)
l_dat$l_trks  <- log(dat$trks)
names(dat)
names(l_dat)
l_dat$l_adt   <- log(dat$adt)
names(dat)
names(l_dat)
l_dat$l_sigs1 <- log(dat$sigs1)
#setwd("C:/Users/lapt3u/Box/UC/Fall_2018/BE7023_Adv_Biostats/adv_biostats/hw_3")
library(car)
dat <- Highway1
dim(dat)
# The Highway1 dataset has 39 rows/observations and 12 columns/variables
# Top 10 rows of Highway1:
head(dat, 10)
# Summary statistics of Highway1:
summary(dat)
# This dataset has auto accident rates per million vehicle miles for 39 stetches of road
# in Minnesota in the year 1973, as well as other variables to describe that stretch of
# road.  It was put together by Carl Hoffstedt.
# Variables:
#   rate:   auto accident rate in 1973 [accidents/million vehicle miles]
#   len:    length of a highway segment [miles]
#   adt:    average daily traffic count in thousands
#   trks:   truck volume as percent of total volume
#   sigs1:  number of signals per mile of roadway
#   slim:   speed limit of stretch of road in 1973
#   shld:   width of outer shoulder on road [feet]
#   lane:   total number of traffic lanes
#   acpt:   nummber of access points per mile
#   itg:    number of freeway-type interchanges per mile
#   lwid:   lane width [feet]
#   htype:  Type of roadway or source of funding for road
sapply(dat, class)
levels(dat$htype)
# All variabes are either numeric or integers (no decimals) except for htype
# which is a factor/categorical with 4 levels, "FAI", "MA", "MC", "PA".
# Construct seperate df for holding our log transformed dataset
l_dat <-  dat[,6:12]
# Transforming variables as needed
l_dat$l_rate  <- log(dat$rate)
l_dat$l_len   <- log(dat$len)
l_dat$l_adt   <- log(dat$adt)
l_dat$l_trks  <- log(dat$trks)
l_dat$l_sigs1 <- log(dat$sigs1)
mod_full <- lm(l_rate ~ . , l_dat)
summary(mod_full)
mod_full$coefficients
