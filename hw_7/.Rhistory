mod$deviance
mod$df.residual
p <- pchisq(res, dof, lower.tail = F)
res <- mod$deviance
dof <- mod$df.residual
p <- pchisq(res, dof, lower.tail = F)
mod2 <- glm(low ~ lwt + race + smoke + ht, data = dat, family = binomial)
summary(mod2)
mod2$coefficients
summary(mod2)
lwt
summary(dat)
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 2,
col = "red", ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(9))
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 2,
col = col[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 2,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * race2) + (0.9436 * race3) +
(1.0716 * smoke1) + (1.749 * ht1)) /
(1 + 0.3520 - (0.0179 * lwt) + (1.2877 * race2) + (0.9436 * race3) +
(1.0716 * smoke1) + (1.749 * ht1)), col = cols[2], lwd = 3,
add = T)
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)), col = cols[3], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)), col = cols[4], lwd = 3,
add = T)
##RACE = 3
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1))), col = cols[5], lwd = 3,
add = T)
# Race = 3, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)), col = cols[6], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)), col = cols[7], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)), col = cols[8], lwd = 3,
add = T)
# RACE = 1
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), col = cols[9], lwd = 3,
add = T)
# Race = 0, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)), col = cols[10], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)), col = cols[11], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[12], lwd = 3,
add = T)
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)), col = cols[3], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)), col = cols[4], lwd = 3,
add = T)
##RACE = 3
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1))), col = cols[5], lwd = 3,
add = T)
# Race = 3, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)), col = cols[6], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)), col = cols[7], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)), col = cols[8], lwd = 3,
add = T)
# RACE = 1
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), col = cols[9], lwd = 3,
add = T)
# Race = 0, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)), col = cols[10], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + 0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)), col = cols[11], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[12], lwd = 3,
add = T)
legend("right", pch = rep(16,12), col = cols, legend =
c("Race = 2, Smoke = Y, HT = Y",
"Race = 2, Smoke = Y, HT = N",
"Race = 2, Smoke = N, HT = Y",
"Race = 2, Smoke = N, HT = N",
"Race = 3, Smoke = Y, HT = Y",
"Race = 3, Smoke = Y, HT = N",
"Race = 3, Smoke = N, HT = Y",
"Race = 3, Smoke = N, HT = N",
"Race = 1, Smoke = Y, HT = Y",
"Race = 1, Smoke = Y, HT = N",
"Race = 1, Smoke = N, HT = Y",
"Race = 1, Smoke = N, HT = N"))
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[11], lwd = 3,
add = T)
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)), col = cols[3], lwd = 3,
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[3], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)), col = cols[4], lwd = 3,
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[3], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[4], lwd = 3,
add = T)
##RACE = 3
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1))), col = cols[5], lwd = 3,
add = T)
# Race = 3, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0))), col = cols[6], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1))), col = cols[7], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0))), col = cols[8], lwd = 3,
add = T)
# RACE = 1
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), col = cols[9], lwd = 3,
add = T)
# Race = 0, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[10], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[11], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[12], lwd = 3,
add = T)
legend("right", pch = rep(16,12), col = cols, legend =
c("Race = 2, Smoke = Y, HT = Y",
"Race = 2, Smoke = Y, HT = N",
"Race = 2, Smoke = N, HT = Y",
"Race = 2, Smoke = N, HT = N",
"Race = 3, Smoke = Y, HT = Y",
"Race = 3, Smoke = Y, HT = N",
"Race = 3, Smoke = N, HT = Y",
"Race = 3, Smoke = N, HT = N",
"Race = 1, Smoke = Y, HT = Y",
"Race = 1, Smoke = Y, HT = N",
"Race = 1, Smoke = N, HT = Y",
"Race = 1, Smoke = N, HT = N"))
legend("topright", pch = rep(16,12), col = cols, legend =
c("Race = 2, Smoke = Y, HT = Y",
"Race = 2, Smoke = Y, HT = N",
"Race = 2, Smoke = N, HT = Y",
"Race = 2, Smoke = N, HT = N",
"Race = 3, Smoke = Y, HT = Y",
"Race = 3, Smoke = Y, HT = N",
"Race = 3, Smoke = N, HT = Y",
"Race = 3, Smoke = N, HT = N",
"Race = 1, Smoke = Y, HT = Y",
"Race = 1, Smoke = Y, HT = N",
"Race = 1, Smoke = N, HT = Y",
"Race = 1, Smoke = N, HT = N"))
# plot P(low =1) as a function of lwt in the presence of various choices
# of race, smoke, and ht.
cols <- palette(rainbow(12))
# RACE = 2
# Race = 2, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), from = 80, to = 250, lwd = 3,
col = cols[1], ylim = c(0,1),
xlab = "Mother's Weight at Last Menstrual Period [lb]",
ylab = "Probability of Birth Weight < 2.5 kg",
main = "Probability of Low Birth Weight - Logistic Regression")
# Race = 2, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[2], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[3], lwd = 3,
add = T)
# Race = 2, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 1) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[4], lwd = 3,
add = T)
##RACE = 3
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 1))), col = cols[5], lwd = 3,
add = T)
# Race = 3, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 1) + (1.749 * 0))), col = cols[6], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 1))), col = cols[7], lwd = 3,
add = T)
# Race = 3, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 1) +
(1.0716 * 0) + (1.749 * 0))), col = cols[8], lwd = 3,
add = T)
# RACE = 1
# Race = 3, smoke = 1, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 1))), col = cols[9], lwd = 3,
add = T)
# Race = 0, smoke = 1, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 1) + (1.749 * 0))), col = cols[10], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 1
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 1))), col = cols[11], lwd = 3,
add = T)
# Race = 0, smoke = 0, ht = 0
curve(exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0)) /
(1 + exp(0.3520 - (0.0179 * x) + (1.2877 * 0) + (0.9436 * 0) +
(1.0716 * 0) + (1.749 * 0))), col = cols[12], lwd = 3,
add = T)
legend("topright", pch = rep(16,12), col = cols, legend =
c("Race = 2, Smoke = Y, HT = Y",
"Race = 2, Smoke = Y, HT = N",
"Race = 2, Smoke = N, HT = Y",
"Race = 2, Smoke = N, HT = N",
"Race = 3, Smoke = Y, HT = Y",
"Race = 3, Smoke = Y, HT = N",
"Race = 3, Smoke = N, HT = Y",
"Race = 3, Smoke = N, HT = N",
"Race = 1, Smoke = Y, HT = Y",
"Race = 1, Smoke = Y, HT = N",
"Race = 1, Smoke = N, HT = Y",
"Race = 1, Smoke = N, HT = N"))
summary(mod2)
res2 <- mod2$deviance
dof2 <- mod2$df.residual
p2 <- pchisq(res2, dof2, lower.tail = F)
round(p2,3)
pred <- predict.glm(mod2, type = "response" )
# Classify the prediction, and build confusion matrix.
pred_class <- ifelse(pred >= 0.5, 1,0)
conf <- table(dat$low, pred_class)
rownames(conf) = c('Obs_Normal', 'Obs_Low')
colnames(conf) = c('Pred_Normal', 'Pred_Low')
conf
# Calculate misclassification rate using confusion matrix.
miss <- round(((conf[2] + conf[3]) / (conf[1] + conf[2] + conf[3] + conf[4])) * 100,2)
cat("The misclassification rate is: ", miss, "%")
round(p, 3)
